# 华为的美食识别入门比赛，第二名方案分享
## 比赛简介
共十类美食，数据分布均衡，比赛方提供了5000张图片的数据集，采用9:1的比例划分为训练集和验证集，最终以预测准确率为评价指标。

本方案在测试集上的的acc为99.2%，排行第二。
## 代码说明
1、数据在images文件夹内，由于数据量较大，没有上传

2、采用3阶段训练法，分别执行train_stage1.sh、train_stage2.sh、train_stage3.sh

3、二阶段需要载入一阶段训练得到的模型，三阶段需要载入二阶段训练得到的模型，通过--model_path参数提供模型路径
## 方案简介
模型方面采用的是efficientnet-b5，数据增强方面使用了随机裁切、翻转、auto_augment、随机擦除以及cutmix, 损失函数采用CrossEntropyLabelSmooth，训练策略方面采用了快照集成（snapshot）思想。

第一阶段训练，图像输入尺寸为400，使用LabelSmooth和cutmix，采用带学习率自动重启的CosineAnnealingWarmRestarts方法，获得5个模型快照，选择val_acc最高的模型，作为第一阶段的训练结果。

第二阶段训练，图像输入尺寸为500，适当调整随机裁切和随机擦除的参数，增加weight_decay，在第一阶段模型的基础上训练获得5个模型快照，选择val_acc最高的模型，作为第二阶段的训练结果。

第三阶段训练，图像输入尺寸为500，关闭cutmix，损失函数采用CrossEntropyLoss，在第二阶段模型的基础上训练获得5个模型快照，选择val_acc最高的模型，作为最终的训练结果。
